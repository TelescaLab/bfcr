group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
eigen_bands %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = Power, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
eigen_bands %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = Power, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)")
eigen_bands %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = Power, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
Group <- 0
Month <- 36
evals <- 3
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
eigen_bands <- cbind(c(get_posterior_eigen2(mcmc_results, evals, zi, alpha)$mean), rep(1:3, each = length(t_paf)), rep(Group, length(t_paf) * 3), rep(Month / 12, length(t_paf) * 3), rep(t_paf, 3))
Group <- 0
Month <- 84
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
eigen_bands <- rbind(eigen_bands, cbind(c(get_posterior_eigen2(mcmc_results, evals, zi, alpha)$mean), rep(1:3, each = length(t_paf)), rep(Group, length(t_paf) * 3), rep(Month / 12, length(t_paf) * 3), rep(t_paf, 3)))
Group <- 0
Month <- 132
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
eigen_bands <- rbind(eigen_bands, cbind(c(get_posterior_eigen2(mcmc_results, evals, zi, alpha)$mean), rep(1:3, each = length(t_paf)), rep(Group, length(t_paf) * 3), rep(Month / 12, length(t_paf) * 3), rep(t_paf, 3)))
Group <- 1
Month <- 36
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
eigen_bands <- rbind(eigen_bands, cbind(c(get_posterior_eigen2(mcmc_results, evals, zi, alpha)$mean), rep(1:3, each = length(t_paf)), rep(Group, length(t_paf) * 3), rep(Month / 12, length(t_paf) * 3), rep(t_paf, 3)))
Group <- 1
Month <- 84
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
eigen_bands <- rbind(eigen_bands, cbind(c(get_posterior_eigen2(mcmc_results, evals, zi, alpha)$mean), rep(1:3, each = length(t_paf)), rep(Group, length(t_paf) * 3), rep(Month / 12, length(t_paf) * 3), rep(t_paf, 3)))
Group <- 1
Month <- 132
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
eigen_bands <- rbind(eigen_bands, cbind(c(get_posterior_eigen2(mcmc_results, evals, zi, alpha)$mean), rep(1:3, each = length(t_paf)), rep(Group, length(t_paf) * 3), rep(Month / 12, length(t_paf) * 3), rep(t_paf, 3)))
colnames(eigen_bands) <- c("Power", "Eigenfunction", "Group", "Age (years)", "Frequency")
eigen_bands <- as_tibble(eigen_bands)
eigen_bands$`Age (years)` <- as.character(eigen_bands$`Age (years)`)
eigen.labs <- c("Eigenfunction 1", "Eigenfunction 2", "Eigenfunction 3")
names(eigen.labs) <- c("1", "2", "3")
group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
eigen_bands %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = Power, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1)
warnings()
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1)
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1)
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1)
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years) == 7`)
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7)
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3)
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7)
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3)
eigen2 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7)
eigen2 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 11)
eigen1
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 11) %>%
select(Power)
eigen1
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 11) %>%
select(Power)
if((eigen2 + eigen1)^2 < (eigen2 - eigen1)^2){
eigen2 <- -eigen2
}
if((eigen3 + eigen1)^2 < (eigen3 - eigen1)^2){
eigen3 <- -eigen3
}
(eigen2 + eigen1)^2
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3) %>%
select(Power) <- eigen1
eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3) %>%
select(Power) %>%
mutate(Power =  eigen1)
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_t <- c(eigen1, eigen2, eigen3)
eigen_t
eigen1
eigen_t <- as.vector(eigen1, eigen2, eigen3)
eigen_t <- as.vector(c(eigen1, eigen2, eigen3))
eigen_t
eigen_t <- rbind(eigen1, eigen2, eigen3)
eigen_t
eigen_t <- NULL
eigen1 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == 0, Eigenfunction == 1, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
eigen_t
eigen_t <- NULL
for(eigenfn in c(1,2,3)){
for(grp in c(0, 1)){
eigen1 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
}
}
length(eigen_t)
rbind(NULL, 1, 2)
for(eigenfn in c(1,2,3)){
for(grp in c(0, 1)){
eigen1 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
}
}
for(eigenfn in c(1,2,3)){
for(grp in c(0, 1)){
eigen1 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
print("hello")
}
}
eigen_t <- NULL
for(eigenfn in c(1,2,3)){
for(grp in c(0, 1)){
eigen1 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
}
}
eigen_t
eigen_tibble <- eigen_bands %>%
arrange(Eigenfunction, Group)
eigen_tibble
eigen_tibble[33,]
eigen_tibble[34,]
eigen_tibble <- eigen_bands %>%
arrange(Eigenfunction, Group) %>%
bind_cols(eigen_t)
eigen_tibble
eigen_t
colnames(eigen_t) <- "eigen_t"
eigen_tibble <- eigen_bands %>%
arrange(Eigenfunction, Group) %>%
bind_cols(eigen_t)
eigen_tibble
eigen_tibble$`Age (years)` <- as.character(eigen_bands$`Age (years)`)
eigen.labs <- c("Eigenfunction 1", "Eigenfunction 2", "Eigenfunction 3")
names(eigen.labs) <- c("1", "2", "3")
group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = Power, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_tibble
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_tibble$`Age (years)` <- as.character(eigen_tibble$`Age (years)`)
eigen_tibble$Eigenfunction <- as.character(eigen_tibble$Eigenfunction)
eigen.labs <- c("Eigenfunction 1", "Eigenfunction 2", "Eigenfunction 3")
names(eigen.labs) <- c("1", "2", "3")
group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_tibble
eigen_bands
eigen_bands %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = Power, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
View(eigen_tibble)
eigen_tibble <- eigen_bands %>%
arrange(Eigenfunction, Group, `Age (years)`) %>%
bind_cols(eigen_t)
eigen_tibble$`Age (years)` <- as.character(eigen_tibble$`Age (years)`)
eigen_tibble$Eigenfunction <- as.character(eigen_tibble$Eigenfunction)
eigen.labs <- c("Eigenfunction 1", "Eigenfunction 2", "Eigenfunction 3")
names(eigen.labs) <- c("1", "2", "3")
group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
Group <- 0
Month <- 36
evals <- 3
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
zi <- c(1, Group, Month_t, Group * Month_t)
get_posterior_eigen2(mcmc_results, evals, zi, alpha)
temp <- get_posterior_eigen2(mcmc_results, evals, zi, alpha)
temp$eigenval_pve_intervals
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (years)") +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "Age (yeaaaars)") +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = "apple") +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill = app) +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
labs(fill=guide_legend(title="New Legend Title")) +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
labs(fill = "Age (years)") +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
labs(fill = "Age ss(years)") +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
labs(fill=guide_legend(title="New Legend Title")) +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
labs(color = "Age (years)") +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
labs(y = "Power", color = "Age (years)") +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
eigen_t <- NULL
for(eigenfn in c(1,2,3)){
for(grp in c(0, 1)){
eigen1 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen1 + eigen_last)^2) < sum((eigen1 - eigen_last)^2)){
eigen1 <- -eigen1
}
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_last <- eigen1
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
}
}
eigen_last <- numeric(length(t_paf))
for(eigenfn in c(1,2,3)){
for(grp in c(0, 1)){
eigen1 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 3) %>%
select(Power)
eigen2 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 7) %>%
select(Power)
eigen3 <- eigen_bands %>%
filter(Group == grp, Eigenfunction == eigenfn, `Age (years)` == 11) %>%
select(Power)
if(sum((eigen1 + eigen_last)^2) < sum((eigen1 - eigen_last)^2)){
eigen1 <- -eigen1
}
if(sum((eigen2 + eigen1)^2) < sum((eigen2 - eigen1)^2)){
eigen2 <- -eigen2
}
if(sum((eigen3 + eigen1)^2) < sum((eigen3 - eigen1)^2)){
eigen3 <- -eigen3
}
eigen_last <- eigen1
eigen_t <- rbind(eigen_t, eigen1, eigen2, eigen3)
}
}
colnames(eigen_t) <- "eigen_t"
eigen_tibble <- eigen_bands %>%
arrange(Eigenfunction, Group, `Age (years)`) %>%
bind_cols(eigen_t)
eigen_tibble$`Age (years)` <- as.character(eigen_tibble$`Age (years)`)
eigen_tibble$Eigenfunction <- as.character(eigen_tibble$Eigenfunction)
eigen.labs <- c("Eigenfunction 1", "Eigenfunction 2", "Eigenfunction 3")
names(eigen.labs) <- c("1", "2", "3")
group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
eigen_tibble %>%
ggplot(aes(x = Frequency)) +
geom_line(aes(y = eigen_t, group = `Age (years)`, color = `Age (years)`)) +
labs(y = "Power", color = "Age (years)") +
facet_grid(Group ~ Eigenfunction, labeller = labeller(Group = group.labs, Eigenfunction = eigen.labs)) +
theme_bw()
Group <- 0
Month <- 36
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
xi <- c(1, Group, Month_t, Group * Month_t)
coef_bands <- cbind(get_posterior_means(mcmc_results, xi, alpha), rep(Group, length(t_paf)), rep(Month / 12, length(t_paf)), t_paf)
Group <- 0
Month <- 84
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
xi <- c(1, Group, Month_t, Group * Month_t)
coef_bands <- rbind(coef_bands, cbind(get_posterior_means(mcmc_results, xi, alpha), rep(Group, length(t_paf)), rep(Month / 12, length(t_paf)), t_paf))
Group <- 0
Month <- 132
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
xi <- c(1, Group, Month_t, Group * Month_t)
coef_bands <- rbind(coef_bands, cbind(get_posterior_means(mcmc_results, xi, alpha), rep(Group, length(t_paf)), rep(Month / 12, length(t_paf)), t_paf))
Group <- 1
Month <- 36
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
xi <- c(1, Group, Month_t, Group * Month_t)
coef_bands <- rbind(coef_bands, cbind(get_posterior_means(mcmc_results, xi, alpha), rep(Group, length(t_paf)), rep(Month / 12, length(t_paf)), t_paf))
Group <- 1
Month <- 84
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
xi <- c(1, Group, Month_t, Group * Month_t)
coef_bands <- rbind(coef_bands, cbind(get_posterior_means(mcmc_results, xi, alpha), rep(Group, length(t_paf)), rep(Month / 12, length(t_paf)), t_paf))
Group <- 1
Month <- 132
Month_t <- (Month - mean(demDat$Age)) / sd(demDat$Age)
xi <- c(1, Group, Month_t, Group * Month_t)
coef_bands <- rbind(coef_bands, cbind(get_posterior_means(mcmc_results, xi, alpha), rep(Group, length(t_paf)), rep(Month / 12, length(t_paf)), t_paf))
colnames(coef_bands) <- c("lower", "mean", "upper", "Group", "Age (years)", "Frequency")
coef_bands <- as_tibble(coef_bands)
coef_bands
age.labs <- c("3 years", "7 years", "11 years")
names(age.labs) <- c("3", "7", "11")
group.labs <- c("TD", "ASD")
names(group.labs) <- c("0", "1")
coef_bands %>%
ggplot(aes(x = Frequency)) +
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.3) +
geom_line(aes(y = mean)) +
facet_grid(Group ~ `Age (years)`,
labeller = labeller(Group = group.labs, `Age (years)` = age.labs)) +
labs(y = "Power") +
theme_bw()
